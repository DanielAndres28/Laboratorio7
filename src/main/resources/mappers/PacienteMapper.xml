<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="edu.eci.pdsw.samples.mybatis.mappers.PacienteMapper">

<resultMap type='Paciente' id='pacResult'>
    <id property='id' column='id'/>
    <result property='nombre' column='nombre'/>
    <result property='fechaNacimiento' column='fecha_nacimiento'/>    
    <collection property='consultas' ofType='Consulta' resultMap="resmConsult" columnPrefix="consult_"></collection>    
</resultMap>

<resultMap type='Consulta' id='resmConsult'>
    <id property='id' column='identificador'/>
    <id property='fechayHora' column='fechyHor'/>
    <result property='resumen' column='descripcion'/>
</resultMap>

<select id = "loadPacienteById" resultMap="pacResult">
   select pac.nombre, pac.fecha_nacimiento, con.idCONSULTAS as consult_identificador, con.fecha_y_hora as consult_fechyHor, con.resumen as consult_descripcion from PACIENTES as pac inner join CONSULTAS as con on con.PACIENTES_id=pac.id and con.PACIENTES_tipo_id=pac.tipo_id where pac.id=#{idpaciente} and pac.tipo_id='CC'
</select>




                                                                                                
</mapper>